# Обновление системы расчета зарплат

## Описание изменений

Была модернизирована система расчета заработной платы в модуле `/finance/payroll` для поддержки нового метода расчета на основе часовых ставок.

## Основные изменения

### 1. Новая модель расчета зарплаты

**Раньше:** Фиксированная базовая зарплата
**Теперь:** Базовая ставка (₸/час) × Количество отработанных часов

### 2. Обновленные типы данных

Добавлены новые поля в `apps/frontend/src/types/salary.ts`:

- `hourlyRate: number` - базовая ставка за час
- `hoursWorked: number` - количество отработанных часов  
- `AllowanceType` - новый enum для типов надбавок
- `SalaryAllowance` - интерфейс для надбавок с поддержкой процентов

### 3. Полностью модернизированная форма расчета (`SalaryForm.tsx`)

#### Современный дизайн и UX
- **Градиентные фоны** для всех секций с тематическими цветами
- **Анимированные элементы** с framer-motion (scale, hover эффекты)
- **Фирменный цвет** проекта `#ca181f` во всем интерфейсе
- **Тени и скругления** для современного внешнего вида
- **Полностью адаптивный** дизайн под все устройства
- **Улучшенный скроллинг** модального окна

#### Расширенная функциональность
- **Секция базовой зарплаты**: 
  - Поля для ставки и часов с валидацией
  - **Кнопка "Импорт из расписания"** для автоматической загрузки часов
  - Анимированный результат расчета в реальном времени
- **Секция надбавок**: 
  - Поддержка фиксированных сумм и процентов от базовой зарплаты
  - Типы надбавок (за стаж, категорию, условия труда, квалификацию)
- **Секция премий**: улучшенный интерфейс с анимациями
- **Секция удержаний**: современный дизайн форм
- **Итоговый расчет**: интерактивные карточки с hover эффектами и пульсирующей анимацией

#### Формула расчета
```
Базовая зарплата = Ставка за час × Количество часов
Надбавки = Сумма всех надбавок (фиксированные + проценты от базовой)
Премии = Сумма всех премий
Общая сумма = Базовая зарплата + Надбавки + Премии
К выплате = Общая сумма - Удержания
```

### 4. Обновленный интерфейс списка зарплат

- Колонка "Оклад" заменена на "Ставка/Часы"
- Отображение часовой ставки и отработанных часов
- Автоматический расчет базовой зарплаты в таблице

### 5. Модальные окна сотрудников

- Детальная информация о расчете базовой зарплаты
- Отображение надбавок с указанием типа (фиксированная сумма/процент)
- Сохранена вся существующая функциональность

## Технические детали

### Файлы изменены
- `apps/frontend/src/types/salary.ts` - обновлены типы данных
- `apps/frontend/src/components/SalaryForm.tsx` - полная переработка компонента
- `apps/frontend/src/pages/Salaries.tsx` - обновления для поддержки новых данных

### Совместимость
Система полностью совместима с существующим API и базой данных. Все изменения касаются только фронтенда.

### Адаптивность
Форма полностью адаптивна:
- Мобильные устройства: поля располагаются в одну колонку
- Планшеты и десктопы: многоколоночная компоновка
- Оптимизированные размеры кнопок и полей для сенсорного ввода

## Использование

1. Откройте страницу `/finance/payroll`
2. Нажмите "Расчет зарплаты" - откроется современная модальная форма
3. Заполните основную информацию:
   - Выберите сотрудника из списка
   - Укажите период (месяц/год)
4. В секции "Расчет базовой зарплаты":
   - Введите базовую ставку за час (например, 15,000 ₸)
   - Введите часы вручную или нажмите **"Импорт"** для загрузки из расписания
   - Наблюдайте автоматический расчет базовой зарплаты
5. Добавьте дополнительные компоненты:
   - **Надбавки**: фиксированные суммы или проценты от базовой зарплаты
   - **Премии**: различные типы бонусов
   - **Удержания**: налоги и другие вычеты
6. В секции "Итоговый расчет" видите финальную сумму к выплате
7. Добавьте комментарий при необходимости
8. Нажмите "Рассчитать" для сохранения

## Пример расчета

```
Педагог: Иванов И.И.
Ставка: 15,000 ₸/час
Часы: 120
Базовая зарплата: 1,800,000 ₸

Надбавки:
- За стаж (10%): 180,000 ₸
- За категорию: 50,000 ₸

Премии:
- За качество: 100,000 ₸

Удержания:
- Подоходный налог: 200,000 ₸

К выплате: 1,930,000 ₸
```

## Дальнейшие улучшения

Возможные направления развития:
- **Полная интеграция с API расписания** для реального импорта часов
- Автоматический расчет надбавок на основе данных HR
- Шаблоны расчета для разных должностей и категорий
- **Темная тема** интерфейса
- Экспорт индивидуальных расчетных листов
- **Массовый расчет** зарплат для всех сотрудников
- История изменений каждого расчета
- **Уведомления** о готовности расчетов
- Интеграция с банковскими системами для выплат

## Технические особенности

### Анимации и интерактивность
- **Плавные переходы** между состояниями
- **Масштабирование элементов** при взаимодействии
- **Пульсирующие эффекты** для итогового расчета
- **Анимированная загрузка** данных

### Адаптивность
- **Мобильные устройства**: одноколоночная компоновка
- **Планшеты**: двухколоночная сетка
- **Десктопы**: полная пятиколоночная сетка для итогового расчета
- **Оптимизированные кнопки** для сенсорного ввода

### Производительность
- **Ленивые вычисления** для расчетов
- **Мемоизация** компонентов
- **Оптимизированный рендеринг** списков
