# Создание студентов для учителей и админов

## Обзор

Добавлена возможность для администраторов и учителей создавать новых студентов напрямую через систему. Это упрощает процесс регистрации студентов и устраняет необходимость в двухэтапном процессе (создание пользователя → зачисление студента).

## Изменения в Backend

### 1. Новый DTO: `CreateFullStudentDto`

```typescript
export class CreateFullStudentDto {
  email: string;          // Email студента
  name: string;           // Имя
  surname: string;        // Фамилия
  password: string;       // Пароль
  phone?: string;         // Телефон (опционально)
  middlename?: string;    // Отчество (опционально)
  avatar?: string;        // URL аватара (опционально)
  groupId: number;        // ID группы для зачисления
  classId?: number;       // ID класса (опционально)
}
```

### 2. Новый метод в сервисе: `createFullStudent`

- Создает пользователя с ролью `STUDENT`
- Автоматически зачисляет его в указанную группу
- Использует транзакцию для обеспечения целостности данных
- Проверяет права доступа (учителя могут создавать только студентов)

### 3. Новый endpoint: `POST /students/create-full`

**Права доступа:** `ADMIN`, `HR`, `TEACHER`

**Пример запроса:**
```json
{
  "email": "student@example.com",
  "name": "Иван",
  "surname": "Петров",
  "password": "securepassword",
  "phone": "+7 700 123 45 67",
  "middlename": "Сергеевич",
  "groupId": 1
}
```

**Пример ответа:**
```json
{
  "success": true,
  "message": "Student Петров Иван successfully created and enrolled",
  "student": {
    "id": 123,
    "userId": 456,
    "groupId": 1,
    "user": {
      "id": 456,
      "email": "student@example.com",
      "name": "Иван",
      "surname": "Петров",
      "role": "STUDENT"
    },
    "group": {
      "id": 1,
      "name": "Группа А",
      "courseNumber": 1
    }
  }
}
```

## Изменения в Frontend

### 1. Обновленный сервис студентов

Добавлен новый метод `createFullStudent()` в `studentService`:

```typescript
async createFullStudent(data: CreateFullStudentData) {
  return await apiClient.post('/students/create-full', data);
}
```

### 2. Новый компонент: `CreateStudentForm`

Полнофункциональная форма для создания студентов:

- Валидация всех полей
- Проверка прав доступа
- Обработка ошибок
- Автоматическая загрузка списка групп
- Responsive дизайн

**Использование:**
```typescript
import { CreateStudentForm } from '../components/CreateStudentForm';

// В компоненте
<CreateStudentForm
  onSuccess={() => {
    // Обновить список студентов
    refreshStudents();
  }}
  onClose={() => {
    // Закрыть модальное окно
    setShowCreateForm(false);
  }}
/>
```

## Безопасность

### Контроль доступа
- **Админы**: Полный доступ к созданию студентов
- **Учителя**: Могут создавать только студентов (роль `STUDENT` задается автоматически)
- **Остальные роли**: Доступ запрещен

### Валидация данных
- Проверка уникальности email
- Валидация формата email
- Минимальная длина пароля (6 символов)
- Проверка существования группы
- Защита от SQL-инъекций через Prisma ORM

### Хеширование паролей
Пароли автоматически хешируются с помощью bcrypt (сила 12) перед сохранением в базу данных.

## Преимущества

1. **Упрощенный процесс**: Создание пользователя и зачисление студента в одном действии
2. **Контроль доступа**: Учителя могут самостоятельно добавлять студентов в свои группы
3. **Целостность данных**: Использование транзакций предотвращает создание "висячих" записей
4. **Удобный интерфейс**: Интуитивная форма с валидацией и обработкой ошибок
5. **Масштабируемость**: Легко добавить дополнительные поля или ограничения

## Использование

### Для администраторов
1. Перейти в раздел "Студенты"
2. Нажать "Создать нового студента"
3. Заполнить форму
4. Выбрать группу
5. Подтвердить создание

### Для учителей
1. Учителя видят только группы, к которым у них есть доступ
2. Могут создавать студентов только с ролью `STUDENT`
3. Автоматическое уведомление об успешном создании

## Дальнейшие улучшения

1. **Интеграция с группами**: Автоматическая загрузка групп для конкретного учителя
2. **Массовое создание**: Возможность создания нескольких студентов из CSV файла
3. **Email уведомления**: Автоматическая отправка данных для входа новым студентам
4. **Дополнительные поля**: Возможность добавления фото, даты рождения, адреса и т.д.
5. **Интеграция с внешними системами**: Синхронизация с системами управления учебными заведениями
