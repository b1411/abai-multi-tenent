backe# Финансовый модуль

## Описание
Модуль управления финансами для образовательной системы Fizmat.AI, включающий управление платежами, бюджетом и финансовой отчетностью.

## Компоненты

### Backend
- **BudgetModule** - Модуль управления бюджетом
  - `BudgetController` - API для управления статьями бюджета
  - `BudgetService` - Бизнес-логика работы с бюджетом
  - DTO для создания и обновления статей бюджета
  - Entity для статей бюджета

### Frontend
- **PaymentsPage** - Страница управления платежами и задолженностями
- **financeService** - Сервис для работы с финансовыми данными
- **Типы** - TypeScript типы для финансовых данных

## База данных

### Новые таблицы
1. **BudgetItem** - Статьи бюджета
   - Планируемые и фактические суммы
   - Категории доходов и расходов
   - Периоды планирования
   - Ответственные лица

2. **Payment** - Платежи студентов
   - Различные типы услуг (обучение, питание, транспорт)
   - Статусы оплаты
   - Сроки и суммы платежей

3. **PaymentReminder** - Напоминания об оплате
4. **FinancialReport** - Финансовые отчеты

## Функциональность

### Управление платежами
- ✅ Просмотр всех платежей с фильтрацией
- ✅ Статистика по платежам (общие суммы, проценты сбора)
- ✅ Отправка напоминаний об оплате
- ✅ Генерация квитанций
- ✅ Экспорт данных
- ✅ Детальная информация по каждому платежу

### Управление бюджетом
- ✅ CRUD операции со статьями бюджета
- ✅ Аналитика доходов и расходов
- ✅ Группировка по категориям
- ✅ Отчеты по отклонениям от плана
- ✅ Закрытие бюджетных периодов

### Аналитика
- ✅ Сводная статистика по платежам
- ✅ Анализ бюджетных отклонений
- ✅ Группировка по категориям
- ✅ Расчет процентов сбора платежей

## API Endpoints

### Бюджет
- `GET /budget` - Получить статьи бюджета с фильтрацией
- `GET /budget/:id` - Получить статью бюджета
- `POST /budget` - Создать статью бюджета
- `PATCH /budget/:id` - Обновить статью бюджета
- `DELETE /budget/:id` - Удалить статью бюджета
- `GET /budget/analytics/:period` - Получить аналитику по периоду
- `POST /budget/periods/:period/close` - Закрыть период

### Платежи (планируется)
- `GET /payments` - Получить платежи с фильтрацией
- `POST /payments` - Создать платеж
- `POST /payments/:id/pay` - Провести оплату
- `POST /payments/:id/remind` - Отправить напоминание
- `GET /payments/:id/invoice` - Сгенерировать квитанцию

## Роли и доступ

### FINANCIST
- Полный доступ ко всем функциям модуля
- Управление бюджетом и платежами
- Генерация отчетов

### ADMIN
- Полный доступ ко всем функциям
- Настройка системы

### PARENT
- Просмотр платежей своих детей
- Оплата задолженностей

## Навигация
Доступ к модулю через боковое меню:
`Финансы → Оплаты и задолженности` - `/finance/payments`

## Интеграция с API
Модуль полностью интегрирован с backend API:
- ✅ Загрузка данных о платежах через financeService
- ✅ Фильтрация и поиск платежей
- ✅ Отправка напоминаний об оплате
- ✅ Генерация квитанций (PDF/DOCX)
- ✅ Экспорт данных (XLSX/CSV)
- ✅ Обработка ошибок и состояний загрузки
- ✅ Отображение пустого состояния при отсутствии данных

## Планы развития
- [ ] Страница бюджета (`/finance/budget`)
- [ ] Финансовые отчеты (`/finance/reports`)
- [ ] Автоматические напоминания
- [ ] Интеграция с платежными системами
- [ ] Прогнозирование бюджета с помощью ИИ
- [ ] Мобильное приложение для родителей
- [ ] Создание новых платежей через интерфейс
- [ ] Batch операции (массовые действия)
