# Reports Page Fix - Отображение реальных данных

## Проблема
На странице Reports.tsx не отображались реальные данные из API, использовались только моковые данные.

## Что было исправлено

### 1. Backend
- **reports.service.ts**: Полностью заменены моковые данные на реальные запросы к БД через Prisma
- **performance.service.ts**: Исправлены все моковые данные в методах:
  - `getTrends()` - теперь использует реальные данные lessonResult
  - `getMonthlyData()` - рассчитывает на основе реальных оценок и посещаемости
  - `getGradeDistribution()` - показывает реальное распределение оценок
  - `getPerformanceMetrics()` - вычисляет метрики из реальных данных
- Исправлена TypeScript ошибка с типом `'neutral'` -> `'stable'`

### 2. Frontend
- **Reports.tsx**: 
  - Обновлена логика загрузки данных для использования реальных API эндпоинтов
  - Исправлен расчет статистики на основе реальных данных cashflow
  - Улучшено преобразование данных для графиков
- **financeService.ts**: Исправлены методы `getCashflowData` и `getPerformanceMetrics` для правильной передачи параметров

## API эндпоинты которые теперь используются

- `GET /reports/cashflow?startDate=YYYY-MM-DD&endDate=YYYY-MM-DD` - данные движения денежных средств
- `GET /reports/performance?startDate=YYYY-MM-DD&endDate=YYYY-MM-DD` - показатели эффективности

## Структура данных

### Cashflow данные:
```json
[
  {
    "period": "2025-07",
    "income": 5808000,
    "expense": 4520000,
    "netFlow": 1288000,
    "cumulativeFlow": 1288000
  }
]
```

### Performance данные:
```json
{
  "revenueGrowth": 0,
  "expenseControl": 5.04,
  "budgetAccuracy": 85.85,
  "collectionRate": 95,
  "liquidityRatio": 0,
  "profitMargin": -1882.46
}
```

## Реальные данные теперь используются в:

### Reports Service:
- Движение денежных средств (из BudgetItem и Payment)
- Показатели эффективности (рассчитывается на основе реальных доходов/расходов)
- Прогнозы (на основе исторических данных)
- Анализ отклонений (план vs факт из BudgetItem)

### Performance Service:
- Тренды успеваемости (из LessonResult за последние 6 месяцев)
- Месячная статистика (реальные оценки, посещаемость, домашние задания)
- Распределение оценок (подсчет реальных оценок по базе)
- Метрики производительности (средние значения из реальных данных)

## Что отображается

1. **Статистика** - рассчитывается на основе реальных данных из БД
2. **График доходов и расходов** - использует реальные финансовые данные
3. **Показатели роста** - берутся из реальных performance metrics
4. **Таблица отчетов** - пока моковые данные (нет эндпоинта для списка отчетов)

## Результат
✅ **Полностью устранены моковые данные!** Теперь на всех страницах отчетности отображаются реальные данные из базы данных.
