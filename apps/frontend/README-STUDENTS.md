# Модуль "Студенты" - Документация

## Обзор
Модуль "Студенты" предоставляет полнофункциональную систему управления студентами с учетом ролей и прав доступа. Система интегрирована с бекендом и поддерживает различные уровни доступа для разных типов пользователей.

## Структура файлов

### Сервисы
- `src/services/studentService.ts` - API клиент для работы со студентами
- `src/hooks/useStudents.ts` - React хуки для управления состоянием студентов

### Страницы
- `src/pages/Students.tsx` - Список студентов с фильтрацией и поиском
- `src/pages/StudentDetail.tsx` - Детальная информация о студенте

## Возможности

### 1. Список студентов (`/students`)

#### Функционал:
- **Поиск** по имени и email
- **Фильтрация** по группам
- **Адаптивная сетка** карточек студентов
- **Контроль доступа** в зависимости от роли пользователя

#### Уровни доступа:
- **Полный доступ** (ADMIN, HR, TEACHER): видят всех студентов с полной информацией
- **Групповой доступ** (STUDENT): видят только свою группу
- **Семейный доступ** (PARENT): видят только своих детей
- **Ограниченный доступ**: базовая информация об одногруппниках

### 2. Детальная информация о студенте (`/students/:id`)

#### Вкладки (для полного доступа):
- **Обзор**: основная информация, последние результаты, родители
- **Успеваемость**: оценки по предметам, статистика
- **Посещаемость**: история посещений (в разработке)
- **Финансы**: платежи и задолженности (в разработке)
- **Эмоциональное состояние**: психологические показатели

#### Контроль доступа:
- Проверка прав на уровне компонента
- Ограничение отображения данных по ролям
- Перенаправление при отсутствии прав

## API интеграция

### Основные endpoints:
```typescript
// Получить всех студентов
GET /students

// Получить студентов группы
GET /students/group/:groupId

// Получить студента по ID
GET /students/:id

// Получить студента по ID пользователя
GET /students/user/:userId

// Получить оценки студента
GET /students/:id/grades

// Получить статистику студентов
GET /students/statistics

// Получить родителей студента
GET /students/:id/parents
```

### Управление студентами (для ADMIN/HR):
```typescript
// Зачислить студента
POST /students

// Обновить данные студента
PATCH /students/:id

// Перевести в другую группу
PATCH /students/:id/change-group/:newGroupId

// Привязать/отвязать родителя
POST /students/:id/parents/:parentId
DELETE /students/:id/parents/:parentId

// Отчислить студента
DELETE /students/:id
```

## Типы данных

### Student Interface
```typescript
interface Student {
  id: number;
  userId: number;
  groupId: number;
  createdAt: string;
  updatedAt: string;
  user: {
    id: number;
    email: string;
    name: string;
    surname: string;
    middlename?: string;
    phone?: string;
    avatar?: string;
    role: string;
  };
  group: {
    id: number;
    name: string;
    courseNumber: number;
  };
  Parents?: Parent[];
  lessonsResults?: LessonResult[];
  EmotionalState?: EmotionalState;
  Payment?: Payment[];
}
```

## Права доступа по ролям

| Роль | Видимость | Действия |
|------|-----------|----------|
| **ADMIN** | Все студенты | Полное управление |
| **HR** | Все студенты | Зачисление, перевод, отчисление |
| **TEACHER** | Все студенты | Просмотр, оценивание |
| **STUDENT** | Своя группа | Просмотр ограниченной информации |
| **PARENT** | Свои дети | Полная информация о детях |

## Компоненты и хуки

### useStudents()
```typescript
const {
  students,      // Список студентов
  loading,       // Состояние загрузки
  error,         // Ошибки
  refetch,       // Обновить данные
  fetchStudentsByGroup  // Загрузить по группе
} = useStudents();
```

### useStudent(id)
```typescript
const {
  student,       // Данные студента
  grades,        // Оценки
  loading,       // Состояние загрузки
  error,         // Ошибки
  refetch,       // Обновить данные
  fetchGrades    // Загрузить оценки
} = useStudent(studentId);
```

## Навигация

Страницы студентов доступны через боковую панель:
- **Студенты** → **Списки учащихся** → `/students`
- Детальная страница доступна по клику на карточку студента

## Особенности реализации

### Безопасность
- Проверка прав доступа на клиенте и сервере
- Фильтрация данных по ролям
- Защита от несанкционированного доступа

### UX/UI
- Адаптивный дизайн для всех устройств
- Интуитивная навигация с хлебными крошками
- Модальные окна для ограниченного доступа
- Индикаторы уровня доступа

### Производительность
- Ленивая загрузка данных
- Кэширование в хуках
- Оптимизация рендеринга списков

## Планы развития

### В разработке:
- Полная реализация вкладки "Посещаемость"
- Управление финансами студентов
- Интеграция с системой чатов
- Экспорт данных в различные форматы

### Будущие улучшения:
- Система уведомлений для родителей
- Мобильное приложение
- Расширенная аналитика
- Интеграция с внешними системами
